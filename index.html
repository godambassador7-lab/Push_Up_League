<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0b0b10" />
  <title>Push Up League</title>
  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="icon" href="./assets/icons/icon-192.png" />
  <link rel="stylesheet" href="./styles.css" />
  <meta name="description" content="Track push-ups, earn XP & titles. Integrity first." />
</head>
<body>
  <header>
    <div class="brand">
      <img src="./assets/icons/icon-192.png" class="logo" alt="Push Up League Logo" />
      <div>
        <div>Push Up League</div>
        <div class="tag">Integrity • XP • Titles</div>
      </div>
    </div>
    <div class="row">
      <span id="userBox" class="muted">Guest</span>
      <button id="signInBtn" class="btn-ghost">Sign In</button>
      <button id="signOutBtn" class="btn-ghost hidden">Sign Out</button>
    </div>
  </header>

  <main>
    <section class="card">
      <h2 class="section-title">Today</h2>
      <div class="logger">
        <div class="qty">
          <button id="minusBtn" aria-label="decrease">−</button>
          <input id="reps" type="number" inputmode="numeric" pattern="[0-9]*" placeholder="Push-ups" />
          <button id="plusBtn" aria-label="increase">+</button>
        </div>
        <button id="logBtn">Log</button>
        <span class="chip">Locked today: <strong id="lockedFlag"></strong></span>
      </div>
      <div class="stat-row" style="margin-top:12px">
        <div class="chip">XP: <strong id="xp">0</strong></div>
        <div class="chip">Streak: <strong id="streak">0</strong></div>
        <div class="chip">Total: <strong id="totalReps">0</strong></div>
        <div class="chip">Active Title: <strong id="activeTitleText"></strong></div>
      </div>
      <div style="margin-top:12px">
        <div class="muted">Integrity</div>
        <div class="meter"><span id="integrityMeter" style="width:100%"></span></div>
      </div>
    </section>

    <section class="card">
      <h2 class="section-title">Locked Days</h2>
      <div id="lockDaysWrap" class="row"></div>
      <div class="calendar" id="miniCal">
        <div class="cal-monthbar">
          <button id="calPrev" class="btn-ghost">◀</button>
          <div id="calLabel"></div>
          <button id="calNext" class="btn-ghost">▶</button>
        </div>
        <div class="cal-head">
          <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>
        </div>
        <div class="cal-grid" id="calGrid"></div>
      </div>
      <p class="muted">Only logs on locked days earn XP. Toggle your commitment days here.</p>
    </section>

    <section class="card">
      <h2 class="section-title">Achievements</h2>
      <div id="achWrap" class="badges"></div>
    </section>

    <section class="card">
      <h2 class="section-title">Legendary Titles Shop</h2>
      <div id="titleShop" class="grid"></div>
    </section>

    <section class="card">
      <h2 class="section-title">Account</h2>
      <div class="row" style="gap:8px;flex-wrap:wrap">
        <button id="googleBtn">Sign in with Google</button>
        <button id="emailCreateBtn" class="btn-ghost">Create email account</button>
        <button id="emailSignBtn" class="btn-ghost">Email sign in</button>
      </div>
      <p class="muted">After signing in, your progress stays on this device (local). You can later add cloud sync if desired.</p>
    </section>

    <section class="card">
      <h2 class="section-title">Install</h2>
      <button id="installBtn">Install PWA</button>
      <p class="muted">On iOS: Share → Add to Home Screen. On Android/Chrome: Install from address bar icon or browser menu.</p>
    </section>
  </main>

  <footer>© Push Up League — Integrity over everything.</footer>

  <script type="module">
    // Quick flag for locked today
    import './app.js';
    const lockedFlag = document.getElementById('lockedFlag');
    function checkLocked(){
      const dow = new Date().getDay();
      const data = JSON.parse(localStorage.getItem('pul-v2'))||{};
      const locks = data.lockDays||[1,3,5];
      lockedFlag.textContent = locks.includes(dow) ? 'YES' : 'NO';
      setTimeout(checkLocked, 2000);
    }
    checkLocked();

    // Wire signInBtn to Google for convenience
    document.getElementById('signInBtn').addEventListener('click', ()=>{
      document.getElementById('googleBtn').click();
    });
  </script>
</body>
</html>
